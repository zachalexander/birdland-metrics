<div class="home-layout">
  <!-- Hero -->
  <section class="hero">
    @if (oriolesOdds(); as odds) {
      <div class="hero-top">
        <div class="hero-question">
          <h1 class="hero-label">
            <span class="hero-label-full">Are the O's Making the Playoffs in 2026?</span>
            <span class="hero-label-short">Are the O's Making the Playoffs in 2026?</span>
          </h1>
          <p class="hero-meta hero-meta-full">Model updated daily in-season from 10,000 simulated seasons.</p>
          <div class="hero-question-divider"></div>
        </div>
        <div class="hero-numbers">
          <div class="hero-big-wrap">
            <div class="hero-gauge" [style.--pct]="odds.playoff_pct">
              <svg class="gauge-ring" viewBox="0 0 120 120">
                <circle class="gauge-track" cx="60" cy="60" r="54" />
                <circle class="gauge-fill" cx="60" cy="60" r="54"
                  [style.stroke-dashoffset]="339.29 - (339.29 * odds.playoff_pct / 100)" />
              </svg>
              <div class="gauge-inner">
                <span class="hero-big">{{ animatedPct() }}<span class="hero-pct">%</span></span>
                <span class="hero-big-label">chance</span>
              </div>
            </div>
          </div>
          @if (oriolesWins(); as wins) {
            <div class="hero-stat-divider"></div>
            <div class="hero-outcome">
              <p class="hero-outcome-label">Most likely model outcome</p>
              <p class="hero-outcome-wins">
                <span class="hero-outcome-number">{{ animatedWins() }}</span>
                <span class="hero-outcome-unit">wins</span>
              </p>
              <a routerLink="/visualizations/win-distribution" class="hero-outcome-link">
                See all possible outcomes &rsaquo;
              </a>
            </div>
          }
        </div>
      </div>
    } @else {
      <div class="hero-question">
        <h1 class="hero-label">Birdland Metrics</h1>
        <p class="hero-meta">Data-driven analysis and projections for the Baltimore Orioles.</p>
      </div>
    }
  </section>

</div>

@if (!dashboardLoading()) {
  <!-- AL East Race -->
  <section class="race-band">
    <p class="section-kicker race-kicker">{{ oddsSeason() + ' Season' }}</p>
    <h2 class="section-heading race-heading">{{ oddsSeason() === 2026 ? "The Daily Playoff Pulse" : oddsSeason() + ' Playoff In-Season Projections' }}</h2>
    @if (oddsSeason() === 2026) {
      <p class="race-subtext">Every win, every loss, every shake-up shifts the odds. Check back daily to see where the O's stand in the playoff race.</p>
    }
    <div class="race-controls">
      <div class="toggle-controls">
        <div class="seg-toggle">
          @for (year of [2024, 2025, 2026]; track year) {
            <button class="seg-btn" [class.seg-active]="oddsSeason() === year"
                    (click)="setOddsSeason(year)">
              {{ year === 2026 ? 'Current' : year }}
            </button>
          }
        </div>
        <div class="seg-toggle">
          <button class="seg-btn" [class.seg-active]="!showAllTeams()"
                  (click)="showAllTeams.set(false)">Orioles</button>
          <button class="seg-btn" [class.seg-active]="showAllTeams()"
                  (click)="showAllTeams.set(true)">AL East</button>
        </div>
      </div>
      @if (oddsSeason() === 2026 && lastRunDate(); as runDate) {
        <span class="race-updated">Updated {{ runDate }}</span>
      }
    </div>
    <app-playoff-race
      [config]="{ teams: ['BAL', 'NYY', 'BOS', 'TB', 'TOR'] }"
      [season]="oddsSeason()"
      [projections]="projections()"
      [odds]="allOdds()"
      [showAllTeams]="showAllTeams()"
    />
  </section>
}

<app-newsletter-cta />

<section class="editorial-band">

  <!-- Section header -->
  <div class="editorial-header">
    <h2 class="section-heading editorial-heading">The Latest</h2>
    <a routerLink="/articles" class="editorial-view-all">View All Articles &#8250;</a>
  </div>

  <!-- Content area -->
  <div class="editorial-content">
    <!-- Featured Article -->
    @if (!loading() && featuredArticle(); as feat) {
      <section class="featured section-card section-card-featured">
        <a [routerLink]="['/articles', feat.slug]" class="featured-link">
          @if (feat.coverImage) {
            <div class="featured-image">
              <picture>
                <source
                  type="image/avif"
                  [srcset]="feat.coverImage.url + '?w=600&h=320&fit=fill&fm=avif 600w, ' + feat.coverImage.url + '?w=1200&h=520&fit=fill&fm=avif 1200w'"
                  sizes="(max-width: 768px) 100vw, 800px"
                />
                <source
                  type="image/webp"
                  [srcset]="feat.coverImage.url + '?w=600&h=320&fit=fill&fm=webp 600w, ' + feat.coverImage.url + '?w=1200&h=520&fit=fill&fm=webp 1200w'"
                  sizes="(max-width: 768px) 100vw, 800px"
                />
                <img
                  [src]="feat.coverImage.url + '?w=1200&h=520&fit=fill'"
                  [alt]="feat.coverImage.title"
                  width="1200"
                  height="520"
                />
              </picture>
              <div class="featured-overlay">
                <div class="featured-overlay-content">
                  <p class="section-kicker featured-kicker-overlay">Spotlight</p>
                  <div class="featured-body featured-body-overlay">
                    @if (feat.tags.length) {
                      <span class="featured-tag">{{ feat.tags[0] }}</span>
                    }
                    <h2 class="featured-title">{{ feat.title }}</h2>
                    <div class="featured-meta">
                      @if (feat.author?.avatar) {
                        <img class="featured-avatar" [src]="feat.author!.avatar!.url + '?w=48&h=48&fit=fill&fm=webp'" [alt]="feat.author!.name" width="18" height="18" />
                      }
                      @if (feat.author?.name) {
                        <span>{{ feat.author?.name }}</span>
                        <span class="featured-meta-dot">&middot;</span>
                      }
                      <span>{{ feat.readingTime }} min read</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          } @else {
            <div class="featured-body">
              <p class="section-kicker">Spotlight</p>
              @if (feat.tags.length) {
                <span class="featured-tag">{{ feat.tags[0] }}</span>
              }
              <h2 class="featured-title">{{ feat.title }}</h2>
              <div class="featured-meta">
                @if (feat.author?.avatar) {
                  <img class="featured-avatar" [src]="feat.author!.avatar!.url + '?w=48&h=48&fit=fill&fm=webp'" [alt]="feat.author!.name" width="18" height="18" />
                }
                @if (feat.author?.name) {
                  <span>{{ feat.author?.name }}</span>
                  <span class="featured-meta-dot">&middot;</span>
                }
                <span>{{ feat.readingTime }} min read</span>
              </div>
            </div>
          }
        </a>
      </section>
    }

    <!-- Latest Articles -->
    <section class="articles-section">
      @if (loading()) {
        <div class="loading-area">
          @for (_ of [1,2,3]; track $index) {
            <div class="skeleton-article">
              <div class="skeleton-thumb"></div>
              <div class="skeleton-text">
                <div class="skeleton-line short"></div>
                <div class="skeleton-line"></div>
                <div class="skeleton-line medium"></div>
              </div>
            </div>
          }
        </div>
      } @else if (latestPreviewArticles().length === 0) {
        <p class="empty-state">No articles yet. Check back soon for data-driven baseball analysis.</p>
      } @else {
        <div class="articles-list">
          @for (article of latestPreviewArticles(); track article.slug) {
            <app-article-card [article]="article" variant="spotlight" />
          }
        </div>
      }
    </section>
  </div>

</section>

<!-- Data Visualizations divider -->
<div class="divider-band">
  <div class="divider-line"></div>
  <span class="divider-label">Data Visualizations</span>
  <div class="divider-line"></div>
</div>

<!-- Core Players Promo -->
<section class="promo-band">
  <a routerLink="/visualizations/core-benchmarks" class="promo-link">
    <div class="promo-image">
      <img src="assets/covers/cowser-westburg-bradish-cover-1.jpg"
           alt="Colton Cowser, Jordan Westburg, and Kyle Bradish"
           width="1200" height="630" loading="lazy" />
      <div class="promo-overlay">
        <div class="promo-body">
          <span class="promo-tag">Player Analysis</span>
          <h2 class="promo-title">Are the O's Core Players Living Up to the Hype?</h2>
          <p class="promo-subtext">Track their personalized benchmarks for the 2026 season and monitor their progress with daily in-season stat updates.</p>
        </div>
      </div>
    </div>
  </a>
</section>

<!-- Win Expectancy divider -->
<div class="divider-band">
  <div class="divider-line"></div>
  <span class="divider-label">Win Expectancy</span>
  <div class="divider-line"></div>
</div>

<div class="home-layout home-layout-bottom">
  @if (!dashboardLoading() && recentGames().length) {
    <!-- Recent Games -->
    <section class="recent-section section-card section-card-momentum">
      <p class="section-kicker">Recent Orioles Games</p>
      <app-recent-games [games]="recentGames()" [gameType]="gamesType()" />
    </section>
  }

</div>
