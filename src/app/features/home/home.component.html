<div class="home-layout">
  <!-- Hero -->
  <section class="hero">
    @if (oriolesOdds(); as odds) {
      <div class="hero-question">
        <h1 class="hero-label">
          <span class="hero-label-full">Are the O's Making the Playoffs?</span>
          <span class="hero-label-short">Are the O's Making the Playoffs?</span>
        </h1>
        <p class="hero-meta hero-meta-full">Updated daily, based on 10,000 simulated seasons</p>
      </div>
      <div class="hero-numbers">
        <div class="hero-big-wrap">
          @if (lastRunDate(); as runDate) {
            <span class="hero-updated">Last run {{ runDate }}</span>
          }
          <div class="hero-gauge" [style.--pct]="odds.playoff_pct">
            <svg class="gauge-ring" viewBox="0 0 120 120">
              <circle class="gauge-track" cx="60" cy="60" r="54" />
              <circle class="gauge-fill" cx="60" cy="60" r="54"
                [style.stroke-dashoffset]="339.29 - (339.29 * odds.playoff_pct / 100)" />
            </svg>
            <div class="gauge-inner">
              <span class="hero-big">{{ odds.playoff_pct | number: '1.0-0' }}<span class="hero-pct">%</span></span>
              <span class="hero-big-label">probability</span>
            </div>
          </div>
          <span class="hero-breakdown">AL East {{ odds.division_pct | number: '1.0-0' }}% &middot; Wild Card {{ odds.wildcard_pct | number: '1.0-0' }}%</span>
        </div>
      </div>
    } @else {
      <div class="hero-question">
        <h1 class="hero-label">Birdland Metrics</h1>
        <p class="hero-meta">Data-driven analysis and projections for the Baltimore Orioles.</p>
      </div>
    }
  </section>

  <hr class="divider" />

  <!-- Featured Article -->
  @if (!loading() && featuredArticle(); as feat) {
    <section class="featured">
      <a [routerLink]="['/articles', feat.slug]" class="featured-link">
        @if (feat.coverImage) {
          <div class="featured-image">
            <picture>
              <source
                type="image/avif"
                [srcset]="feat.coverImage.url + '?w=600&h=320&fit=fill&fm=avif 600w, ' + feat.coverImage.url + '?w=1200&h=520&fit=fill&fm=avif 1200w'"
                sizes="(max-width: 768px) 100vw, 800px"
              />
              <source
                type="image/webp"
                [srcset]="feat.coverImage.url + '?w=600&h=320&fit=fill&fm=webp 600w, ' + feat.coverImage.url + '?w=1200&h=520&fit=fill&fm=webp 1200w'"
                sizes="(max-width: 768px) 100vw, 800px"
              />
              <img
                [src]="feat.coverImage.url + '?w=1200&h=520&fit=fill'"
                [alt]="feat.coverImage.title"
                width="1200"
                height="520"
              />
            </picture>
          </div>
        }
        <div class="featured-body">
          @if (feat.tags.length) {
            <span class="featured-tag">{{ feat.tags[0] }}</span>
          }
          <h2 class="featured-title">{{ feat.title }}</h2>
          <p class="featured-excerpt">{{ feat.excerpt }}</p>
          <span class="featured-read">Read article &rsaquo;</span>
        </div>
      </a>
    </section>
    <hr class="divider" />
  }

  @if (!dashboardLoading()) {
    <!-- AL East Race -->
    @if (projections().length) {
      <section class="race-section">
        <h2 class="section-title">AL East Race</h2>
        <div class="race-grid">
          <app-win-distribution [config]="{ teams: ['BAL', 'NYY', 'BOS', 'TB', 'TOR'] }" />
          <app-standings-table [projections]="projections()" [odds]="allOdds()" />
        </div>
      </section>
      <hr class="divider" />
    }

    <!-- Recent Games -->
    @if (recentGames().length) {
      <app-recent-games [games]="recentGames()" [gameType]="gamesType()" />
      <hr class="divider" />
    }
  }

  <!-- Newsletter -->
  <app-newsletter-cta />
  <hr class="divider" />

  <!-- Latest Articles -->
  <section class="articles-section">
    <h2 class="section-title">Latest Articles</h2>
    @if (categories().length) {
      <nav class="category-nav" aria-label="Categories">
        @for (cat of categories(); track cat) {
          <a [routerLink]="['/category', cat]" class="category-pill">{{ cat }}</a>
        }
      </nav>
    }
    @if (loading()) {
      <div class="loading-area">
        @for (_ of [1,2,3]; track $index) {
          <div class="skeleton-article">
            <div class="skeleton-thumb"></div>
            <div class="skeleton-text">
              <div class="skeleton-line short"></div>
              <div class="skeleton-line"></div>
              <div class="skeleton-line medium"></div>
            </div>
          </div>
        }
      </div>
    } @else if (remainingArticles().length === 0) {
      <p class="empty-state">No articles yet. Check back soon for data-driven baseball analysis.</p>
    } @else {
      <div class="articles-list">
        @for (article of remainingArticles(); track article.slug) {
          <app-article-card [article]="article" />
        }
      </div>
    }
  </section>
</div>
