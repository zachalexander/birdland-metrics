@if (loading()) {
  <div class="article-loading">
    <div class="article-container">
      <div class="skeleton-line title-line"></div>
      <div class="skeleton-line meta-line"></div>
      <div class="skeleton-line"></div>
      <div class="skeleton-line"></div>
      <div class="skeleton-line short"></div>
    </div>
  </div>
} @else if (notFound()) {
  <div class="not-found">
    <h1>Article Not Found</h1>
    <p>The article you're looking for doesn't exist.</p>
  </div>
} @else if (article(); as art) {
  <article class="article-detail">
    <div class="article-container article-container-breadcrumbs">
      <nav class="breadcrumbs" aria-label="Breadcrumb">
        <a routerLink="/">Home</a>
        @if (art.tags.length) {
          <span class="breadcrumb-sep">/</span>
          <a [routerLink]="['/category', art.tags[0]]">{{ art.tags[0] }}</a>
        }
        <span class="breadcrumb-sep">/</span>
        <span class="breadcrumb-current">{{ art.title }}</span>
      </nav>
    </div>
    @if (art.coverImage) {
      <div class="article-hero-image">
        <picture>
          <source
            type="image/avif"
            [srcset]="art.coverImage.url + '?w=600&h=300&fit=fill&fm=avif 600w, ' + art.coverImage.url + '?w=1400&h=600&fit=fill&fm=avif 1400w'"
            sizes="(max-width: 768px) 100vw, 1200px"
          />
          <source
            type="image/webp"
            [srcset]="art.coverImage.url + '?w=600&h=300&fit=fill&fm=webp 600w, ' + art.coverImage.url + '?w=1400&h=600&fit=fill&fm=webp 1400w'"
            sizes="(max-width: 768px) 100vw, 1200px"
          />
          <img
            [src]="art.coverImage.url + '?w=1400&h=600&fit=fill'"
            [srcset]="art.coverImage.url + '?w=600&h=300&fit=fill 600w, ' + art.coverImage.url + '?w=1400&h=600&fit=fill 1400w'"
            sizes="(max-width: 768px) 100vw, 1200px"
            [alt]="art.coverImage.title"
            width="1400"
            height="600"
          />
        </picture>
        @if (art.coverImage.description) {
          <p class="hero-image-attribution">{{ art.coverImage.description }}</p>
        }
      </div>
    }
    <div class="article-container">
      @if (art.tags.length) {
        <a class="article-category" [routerLink]="['/category', art.tags[0]]">{{ art.tags[0] }}</a>
      }
      <h1 class="article-title">{{ art.title }}</h1>
      <div class="article-meta">
        @if (art.author) {
          @if (art.author.avatar) {
            <img
              class="author-avatar"
              [src]="art.author.avatar.url + '?w=80&h=80&fit=fill&f=face'"
              [alt]="art.author.name"
              width="40"
              height="40"
            />
          }
          <span class="article-author">{{ art.author.name }}</span>
          <span class="meta-separator">·</span>
        }
        <time class="article-date">{{ art.publishedAt | date: 'MMM d, yyyy' }}</time>
        <span class="meta-separator">·</span>
        <span class="reading-time">{{ art.readingTime }} min read</span>
        <app-share-buttons [title]="art.title" [path]="'/articles/' + art.slug" />
      </div>
      <div class="article-body-row">
        <div class="article-body" #articleBody appVizHost [innerHTML]="bodyHtml()"></div>
        @if (tocHeadings().length >= 3) {
          <aside class="toc-sidebar">
            <app-toc [headings]="tocHeadings()" />
          </aside>
        }
      </div>
      @if (art.author) {
        <app-author-card [author]="art.author" />
      }
      @if (relatedArticles().length) {
        <section class="related-articles">
          <h2 class="related-title">Related Articles</h2>
          <div class="related-list">
            @for (related of relatedArticles(); track related.slug) {
              <app-article-card [article]="related" />
            }
          </div>
        </section>
      }
      <app-newsletter-cta />
    </div>
  </article>
}
